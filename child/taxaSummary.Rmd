```{r data{{thisTaxa}}}

  summariseTaxa <- "{{thisTaxa}}"

  taxaDat <- taxaModsFull %>%
    dplyr::mutate(thisTaxa = gsub(" ","",Taxa)) %>%
    dplyr::filter(thisTaxa == summariseTaxa)

  taxa <- taxaDat$Taxa[[1]]

  common <- taxaDat$Common[[1]]
  
  thisTaxGroup <- taxaDat %>% dplyr::pull(!!ensym(taxGroup))
  
  nTaxGroup <- dat %>%
    dplyr::filter(!!ensym(taxGroup) == thisTaxGroup) %>%
    dplyr::left_join(luTax) %>%
    dplyr::count(Taxa,Common)
  
  commonInTaxGroup <- nTaxGroup %>%
    dplyr::top_n(5) %>%
    dplyr::mutate(text = case_when(is.na(Common) ~ taxa
                                   , !is.na(Common) ~ paste0("_",Taxa,"_: ",Common)
                                   )
                  )

```

## _`r taxa`_: `r common`

### Reporting rate

```{r rrData{{thisTaxa}}}

  mod <- taxaDat$rr[[1]]

  modType <- "reporting rate"

```

The model specification was:

``r format(formula(mod))``

This required the estimation of `r sum(!grepl("^b",names(as_tibble(mod))))` parameters based on `r nrow(mod$data)` data points.

Figure \@ref(fig:rrFig{{thisTaxa}}) shows results from the reporting rate model. Table \@ref(tab:rrTab{{thisTaxa}}) shows the effect of year on reporting rate of _`r taxa`_.

For _`r taxa`_ `r modType` was `r vec_to_sentence(taxaDat$llYearDiff[[1]]$text)` `r paste0("in ",reference, " compared with ", recent)` (Figure \@ref(fig:rrYearDiffPlot{{thisTaxa}})).

<br>

```{r rrFig{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("Reporting rate for _",taxa,"_")}

  taxaDat$rrPostExp[[1]]$plotRibbon

```

<br>

```{r rrTab{{thisTaxa}}}

  recent <- unique(taxaDat$rrYearDiff[[1]]$recent)

  reference <- unique(taxaDat$rrYearDiff[[1]]$reference)
  
  taxaDat$rrYearDiff[[1]] %>%
    dplyr::select(`IBRA Region` = geo1
                  , `IBRA Subregion` = geo2
                  , `Probability` = lower
                  , `Likelihood` = likelihood
                  ) %>%
    kable(caption = paste0("Likelihood of "
                                 ,recent
                                 ," reporting rate being lower than "
                                 ,reference
                                 )
          )

```

<br>

```{r rrYearDiffPlot{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("Difference in ",testYears$year[testYears$type == "recent"]," ",tolower(modType)," compared to ",testYears$year[testYears$type == "reference"]," for _",taxa,"_")}

  taxaDat$rrYearDiffPlot[[1]]

```

<br>

### List length

```{r llData{{thisTaxa}}}

  mod <- taxaDat$ll[[1]]

  modType <- "list length corrected reporting rate"

```

The model specification was:

``r format(formula(mod))``

This required the estimation of `r sum(!grepl("^b",names(as_tibble(mod))))` parameters based on `r nrow(mod$data)` data points.

Figure \@ref(fig:llFig{{thisTaxa}}) shows results from the list length model. Table \@ref(tab:llTab{{thisTaxa}}) shows the effect of year on reporting rate of _`r taxa`_.

For _`r taxa`_ `r modType` was `r vec_to_sentence(taxaDat$llYearDiff[[1]]$text)` `r paste0("in ",reference, " compared with ", recent)` (Figure \@ref(fig:llYearDiffPlot{{thisTaxa}})).

<br>

```{r llFig{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("List length corrected reporting rate for _",taxa,"_")}

  taxaDat$llPostExp[[1]]$plotRibbon

```

<br>

```{r llTab{{thisTaxa}}}

  recent <- unique(taxaDat$llYearDiff[[1]]$recent)

  reference <- unique(taxaDat$llYearDiff[[1]]$reference)
  
  medianLL <- exp(median(taxaDat$ll[[1]]$data$logListLength))

  taxaDat$llYearDiff[[1]] %>%
    dplyr::select(`IBRA Region` = geo1
                  , `IBRA Subregion` = geo2
                  , `Probability` = lower
                  , `Likelihood` = likelihood
                  ) %>%
    kable(caption = paste0("Likelihood of "
                           ,recent
                           ," list length corrected reporting rate being lower than "
                           ,reference
                           , " at median list length of "
                           , medianLL
                           )
          )

```

<br>

```{r llYearDiffPlot{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("Effect of year on list-length-corrected reporting-rate for _", taxa, "_ at median list length of ", medianLL)}

  taxaDat$llYearDiffPlot[[1]]

```

<br>

### Overall

Treating each method and each geographic area as equivalent in determining overall trend, _`r taxa`_ was `r taxaDat$overall[[1]]$yearDiffOverallRes$text` (Figure \@ref(fig:overallYearEffectPlot{{thisTaxa}})).

<br>

```{r overallYearEffectPlot{{thisTaxa}}, fig.width = 7, fig.cap = paste0("Overall effect of year on _",taxa,"_")}

  taxaDat$overall[[1]]$yearDiffOverallPlot  

```
