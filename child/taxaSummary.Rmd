```{r data{{thisTaxa}}}

  summariseTaxa <- "{{thisTaxa}}"

  taxaDat <- taxaModsFull %>%
    dplyr::mutate(thisTaxa = gsub(" ","",Taxa)) %>%
    dplyr::filter(thisTaxa == summariseTaxa)

  taxa <- taxaDat$Taxa[[1]]

  common <- taxaDat$Common[[1]]
  
  thisTaxGroup <- taxaDat %>% dplyr::pull(!!ensym(taxGroup))
  
  nTaxGroup <- dat %>%
    dplyr::filter(!!ensym(taxGroup) == thisTaxGroup) %>%
    dplyr::left_join(luTax) %>%
    dplyr::count(Taxa,Common)
  
  commonInTaxGroup <- nTaxGroup %>%
    dplyr::top_n(5) %>%
    dplyr::mutate(text = case_when(is.na(Common) ~ taxa
                                   , !is.na(Common) ~ paste0("_",Taxa,"_: ",Common)
                                   )
                  )

```

## _`r taxa`_: `r common`

### Reporting rate

```{r rrData{{thisTaxa}}}

  mod <- taxaDat$rr[[1]]

```

The model specification was:

``r format(formula(mod))``

This required the estimation of `r sum(!grepl("^b",names(as_tibble(mod))))` parameters based on `r nrow(mod$data)` data points.

Figure \@ref(fig:rrFig{{thisTaxa}}) shows results from the reporting rate model. Table \@ref(tab:rrTab{{thisTaxa}}) shows the effect of year on reporting rate of _`r taxa`_.

For _`r taxa`_ reporting rate was `r vec_to_sentence(taxaDat$llYearDiff[[1]]$text)` (Figure \@ref(fig:rrYearDiffPlot{{thisTaxa}})).

<br>

```{r rrFig{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("Reporting rate for _",taxa,"_")}

  taxaDat$rrPostExp[[1]]$plotRibbon

```

<br>

```{r rrTab{{thisTaxa}}}

  taxaDat$rrYearDiff[[1]] %>%
    dplyr::select(`IBRA Region` = geo1
                  , `IBRA Subregion` = geo2
                  , `Probability of decline` = lower
                  , `Likelihood of decline` = likelihood
                  ) %>%
    kable(caption = paste0("Likelihood of "
                                 ,recent
                                 ," "
                                 ,tolower(modType)
                                 ," being lower than "
                                 ,reference
                                 )
          )

```

<br>

```{r rrYearDiffPlot{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("Difference in ",testYears$year[testYears$type == "recent"]," ",tolower(modType)," compared to ",testYears$year[testYears$type == "reference"]," for _",taxa,"_")}

  taxaDat$rrYearDiffPlot[[1]]

```

<br>

### List length

```{r llData{{thisTaxa}}}

  mod <- taxaDat$ll[[1]]

```

The model specification was:

``r format(formula(mod))``

This required the estimation of `r sum(!grepl("^b",names(as_tibble(mod))))` parameters based on `r nrow(mod$data)` data points.

Figure \@ref(fig:llFig{{thisTaxa}}) shows results from the list length model. Table \@ref(tab:llTab{{thisTaxa}}) shows the effect of year on reporting rate of _`r taxa`_.

For _`r taxa`_ list length was `r vec_to_sentence(taxaDat$llYearDiff[[1]]$text)` (Figure \@ref(fig:llYearDiffPlot{{thisTaxa}})).

<br>

```{r llFig{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("List length corrected reporting rate for _",taxa,"_")}

  taxaDat$ll[[1]]$plotRibbon

```

<br>

```{r llTab{{thisTaxa}}}

  taxaDat$llYearDiff[[1]] %>%
    dplyr::select(`IBRA Region` = geo1
                  , `IBRA Subregion` = geo2
                  , `Probability of decline` = lower
                  , `Likelihood of decline` = likelihood
                  ) %>%
    kable(caption = paste0("Effect of year on list-length-corrected reporting-rate for _"
                           , taxa
                           , "_ at median list length of "
                           , median(taxaDat$ll[[1]]$mod$data$listLength)
                           )
          )

```

<br>

```{r llYearDiffPlot{{thisTaxa}}, fig.height = 8, fig.width = 7, fig.cap = paste0("Effect of year on list-length-corrected reporting-rate for _", taxa, "_ at median list length of ", median(taxaDat$ll[[1]]$mod$data$listLength))}

  taxaDat$llYearDiffPlot[[1]]

```

<br>
